<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | CF Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                        }
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: 0, transform: 'translateY(20px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            transition: background-color 0.3s, color 0.3s;
        }

        /* Dark Mode */
        .dark body {
            background-color: #050505;
            color: #ffffff;
        }

        .dark .glass-panel {
            background: rgba(24, 24, 27, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .dark .glass-panel-hover:hover {
            background: rgba(39, 39, 42, 0.7);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .dark .stats-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.03) 0%, rgba(255, 255, 255, 0.01) 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Light Mode */
        body {
            background-color: #f3f4f6;
            color: #111827;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .glass-panel-hover:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            transition: all 0.3s ease;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .stats-card {
            background: white;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .glass-panel,
        .stats-card {
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            transition: background-color 0.3s, border-color 0.3s, transform 0.3s;
        }

        .rank-newbie {
            color: #9ca3af;
        }

        .rank-pupil {
            color: #22c55e;
        }

        .rank-specialist {
            color: #06b6d4;
        }

        .rank-expert {
            color: #3b82f6;
        }

        .rank-candidate-master {
            color: #8b5cf6;
        }

        .rank-master {
            color: #f97316;
        }

        .rank-grandmaster {
            color: #ef4444;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col antialiased">
    <!-- Top Navigation -->
    <nav class="sticky top-0 z-40 w-full glass-panel border-b-0">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <img src="macs_logo.png" alt="MACS Logo" class="w-10 h-10 object-contain rounded-full shadow-lg">
                    <span class="font-bold text-xl tracking-tight text-gray-900 dark:text-white">Analytics</span>
                </div>

                <div class="flex items-center gap-6">
                    <div class="hidden md:flex flex-col items-end">
                        <span id="navUserName"
                            class="text-sm font-semibold text-gray-900 dark:text-white leading-none">User</span>
                        <span class="text-xs text-brand-600 dark:text-brand-400 mt-1">Logged In</span>
                    </div>
                    <div class="h-8 w-[1px] bg-gray-200 dark:bg-white/10 hidden md:block"></div>
                    <button id="logoutBtn"
                        class="group flex items-center justify-center w-9 h-9 rounded-full bg-gray-100 dark:bg-white/5 hover:bg-gray-200 dark:hover:bg-white/10 transition-colors border border-gray-200 dark:border-white/10">
                        <svg class="w-4 h-4 text-gray-500 dark:text-gray-400 group-hover:text-black dark:group-hover:text-white transition-colors"
                            fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                            </path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow pt-8 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto w-full text-gray-900 dark:text-white">

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">

            <!-- Left Column: Main Dashboard (8 cols) -->
            <div class="lg:col-span-8 space-y-8">

                <!-- Welcome & Date -->
                <div class="animate-fade-in-up" style="animation-delay: 0ms;">
                    <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight mb-2">
                        Dashboard
                    </h1>
                    <p class="text-gray-500 dark:text-gray-400 text-lg">Track your progress, break limits.</p>
                </div>

                <!-- Core Stats Row -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 animate-fade-in-up" style="animation-delay: 100ms;">
                    <!-- Rating Card -->
                    <div class="stats-card rounded-2xl p-5 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-3 opacity-5 group-hover:opacity-10 transition-opacity">
                            <svg class="w-12 h-12 text-gray-900 dark:text-white" fill="currentColor"
                                viewBox="0 0 20 20">
                                <path
                                    d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                            </svg>
                        </div>
                        <p class="text-xs uppercase tracking-wider text-gray-500 dark:text-gray-500 font-semibold mb-1">
                            Current Rating</p>
                        <p id="userRating" class="text-2xl font-bold tracking-tight">--</p>
                        <div class="h-1 w-12 bg-gray-200 dark:bg-gray-700 mt-3 rounded-full overflow-hidden">
                            <div class="h-full bg-brand-600 dark:bg-white w-2/3"></div>
                        </div>
                    </div>

                    <!-- Rank Card -->
                    <div class="stats-card rounded-2xl p-5 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-3 opacity-5 group-hover:opacity-10 transition-opacity">
                            <svg class="w-12 h-12 text-gray-900 dark:text-white" fill="currentColor"
                                viewBox="0 0 20 20">
                                <path
                                    d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z" />
                            </svg>
                        </div>
                        <p class="text-xs uppercase tracking-wider text-gray-500 dark:text-gray-500 font-semibold mb-1">
                            Global Rank</p>
                        <p id="userRank" class="text-2xl font-bold tracking-tight truncate">--</p>
                        <div class="h-1 w-12 bg-gray-200 dark:bg-gray-700 mt-3 rounded-full overflow-hidden">
                            <div class="h-full bg-brand-600 w-full"></div>
                        </div>
                    </div>

                    <!-- Max Rating -->
                    <div class="stats-card rounded-2xl p-5 relative overflow-hidden group">
                        <p class="text-xs uppercase tracking-wider text-gray-500 dark:text-gray-500 font-semibold mb-1">
                            Max Rating</p>
                        <p id="userMaxRating" class="text-2xl font-bold tracking-tight">--</p>
                        <div class="mt-3 text-xs text-brand-600 dark:text-green-400 font-medium flex items-center">
                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                            Peak
                        </div>
                    </div>

                    <!-- Solved -->
                    <div class="stats-card rounded-2xl p-5 relative overflow-hidden group">
                        <p class="text-xs uppercase tracking-wider text-gray-500 dark:text-gray-500 font-semibold mb-1">
                            Problems Solved</p>
                        <p id="userSolvedCount" class="text-2xl font-bold tracking-tight">--</p>
                        <div class="mt-3 text-xs text-brand-600 dark:text-blue-400 font-medium flex items-center">
                            Total Solves
                        </div>
                    </div>
                </div>

                <!-- Problem of the Day Section -->
                <div class="relative animate-fade-in-up" style="animation-delay: 200ms;">
                    <div
                        class="absolute -inset-1 bg-gradient-to-r from-brand-600 to-red-600 rounded-2xl blur opacity-20 dark:opacity-30">
                    </div>
                    <div class="glass-panel rounded-2xl p-6 sm:p-8 relative">
                        <div class="flex flex-col sm:flex-row justify-between items-start gap-6">

                            <div class="space-y-4">
                                <div class="inline-flex items-center space-x-2">
                                    <span
                                        class="w-2 h-2 rounded-full bg-brand-600 dark:bg-brand-500 animate-pulse"></span>
                                    <span
                                        class="text-brand-600 dark:text-brand-500 font-bold tracking-widest text-xs uppercase">Daily
                                        Challenge</span>
                                </div>
                                <h3 id="potdId" class="text-4xl font-extrabold text-gray-900 dark:text-white">Loading
                                    Problem...</h3>
                                <p id="potdDate" class="text-gray-500 dark:text-gray-400 font-medium"></p>

                                <div id="potdStatusContainer" class="pt-2">
                                    <span id="potdStatusBadge"
                                        class="inline-flex items-center px-4 py-2 rounded-lg bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/10 text-sm font-medium text-gray-500 dark:text-gray-400">
                                        Status: Checking...
                                    </span>
                                </div>
                            </div>

                            <div class="w-full sm:w-auto flex flex-col gap-3">
                                <a id="potdLink" href="#" target="_blank"
                                    class="hidden w-full sm:w-48 bg-black dark:bg-white text-white dark:text-black font-bold py-4 px-6 rounded-xl hover:bg-gray-800 dark:hover:bg-gray-100 transition-all flex items-center justify-center gap-2 transform hover:-translate-y-1 shadow-xl">
                                    <span>Solve Now</span>
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                        </path>
                                    </svg>
                                </a>
                                <p class="text-xs text-center text-gray-500 max-w-[200px] mx-auto">
                                    Refresh page after solving on Codeforces to update status.
                                </p>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- Admin Action Zone (Head Admin) -->
                <div id="headAdminSection" class="hidden animate-fade-in-up" style="animation-delay: 300ms;">
                    <div class="glass-panel rounded-2xl p-6 border-l-4 border-l-brand-600">
                        <h2 class="text-lg font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2">
                            <span
                                class="p-2 rounded-lg bg-brand-100 dark:bg-brand-500/20 text-brand-600 dark:text-brand-400">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z">
                                    </path>
                                </svg>
                            </span>
                            Quick User Enrollment
                        </h2>
                        <form id="addUserForm" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <input type="text" id="newUserName" placeholder="Full Name" required
                                    class="w-full bg-white dark:bg-dark-800 border border-gray-200 dark:border-white/10 rounded-xl px-4 py-3 placeholder-gray-400 dark:placeholder-gray-600 text-gray-900 dark:text-white focus:outline-none focus:border-brand-600 dark:focus:border-brand-500 focus:ring-1 focus:ring-brand-600 dark:focus:ring-brand-500 transition-colors text-sm">
                                <input type="email" id="newUserEmail" placeholder="Email Address" required
                                    class="w-full bg-white dark:bg-dark-800 border border-gray-200 dark:border-white/10 rounded-xl px-4 py-3 placeholder-gray-400 dark:placeholder-gray-600 text-gray-900 dark:text-white focus:outline-none focus:border-brand-600 dark:focus:border-brand-500 focus:ring-1 focus:ring-brand-600 dark:focus:ring-brand-500 transition-colors text-sm">
                                <input type="text" id="newUserHandle" placeholder="CF Handle" required
                                    class="w-full bg-white dark:bg-dark-800 border border-gray-200 dark:border-white/10 rounded-xl px-4 py-3 placeholder-gray-400 dark:placeholder-gray-600 text-gray-900 dark:text-white focus:outline-none focus:border-brand-600 dark:focus:border-brand-500 focus:ring-1 focus:ring-brand-600 dark:focus:ring-brand-500 transition-colors text-sm">
                                <select id="newUserRole"
                                    class="w-full bg-white dark:bg-dark-800 border border-gray-200 dark:border-white/10 rounded-xl px-4 py-3 text-gray-900 dark:text-gray-300 focus:outline-none focus:border-brand-600 dark:focus:border-brand-500 focus:ring-1 focus:ring-brand-600 dark:focus:ring-brand-500 transition-colors text-sm cursor-pointer">
                                    <option value="user">Regular User</option>
                                    <option value="admin">Admin</option>
                                    <option value="head-admin">Head Admin</option>
                                </select>
                            </div>
                            <div class="flex flex-col md:flex-row gap-4 items-center">
                                <input type="password" id="newUserPassword" placeholder="Set Temporary Password"
                                    required
                                    class="w-full md:flex-grow bg-white dark:bg-dark-800 border border-gray-200 dark:border-white/10 rounded-xl px-4 py-3 placeholder-gray-400 dark:placeholder-gray-600 text-gray-900 dark:text-white focus:outline-none focus:border-brand-600 dark:focus:border-brand-500 focus:ring-1 focus:ring-brand-600 dark:focus:ring-brand-500 transition-colors text-sm">
                                <button type="submit"
                                    class="w-full md:w-auto bg-brand-600 hover:bg-brand-500 text-white font-medium px-8 py-3 rounded-xl transition-all shadow-lg shadow-brand-500/20 whitespace-nowrap">
                                    <span id="addUserBtnText">Add User</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

            </div>

            <!-- Right Column: Profile & Navigation (4 cols) -->
            <div class="lg:col-span-4 space-y-8 animate-fade-in-up" style="animation-delay: 150ms;">

                <!-- Profile / Status Card -->
                <div class="glass-panel rounded-2xl p-6">
                    <div class="flex items-center gap-4 mb-6">
                        <div
                            class="w-16 h-16 rounded-2xl bg-gray-200 dark:bg-gradient-to-tr dark:from-gray-700 dark:to-gray-600 flex items-center justify-center text-2xl shadow-inner border border-gray-300 dark:border-white/10">
                            ðŸ‘»
                        </div>
                        <div>
                            <h2 id="profileName" class="text-xl font-bold text-gray-900 dark:text-white"></h2>
                            <span id="profileRole"
                                class="text-xs uppercase tracking-wider bg-gray-100 dark:bg-white/10 px-2 py-1 rounded text-gray-500 dark:text-gray-400">User</span>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div
                            class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-white/5">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Handle</span>
                            <span id="profileHandle"
                                class="text-sm font-medium text-gray-900 dark:text-white font-mono">--</span>
                        </div>
                        <div
                            class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-white/5">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Guild Status</span>
                            <span
                                class="text-sm font-medium text-green-600 dark:text-green-400 flex items-center gap-1">
                                <span class="w-2 h-2 rounded-full bg-green-500"></span> Active
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Admin Navigation (If Admin) -->
                <div id="adminNavSection" class="hidden">
                    <a href="/admin.html" class="block group">
                        <div
                            class="glass-panel glass-panel-hover p-6 rounded-2xl border-l-4 border-l-brand-600 flex items-center justify-between">
                            <div>
                                <h3
                                    class="font-bold text-gray-900 dark:text-white text-lg group-hover:text-brand-600 dark:group-hover:text-brand-400 transition-colors">
                                    Admin Panel</h3>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Manage POTD & Approvals</p>
                            </div>
                            <div
                                class="w-10 h-10 rounded-full bg-gray-100 dark:bg-white/5 flex items-center justify-center group-hover:bg-brand-500/10 transition-colors">
                                <svg class="w-5 h-5 text-gray-400 group-hover:text-brand-500" fill="none"
                                    stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Motivation / Empty Space Filler -->
                <div
                    class="bg-gradient-to-br from-gray-100 to-white dark:from-brand-900/50 dark:to-transparent p-6 rounded-2xl border border-gray-200 dark:border-brand-500/10">
                    <h4 class="font-bold text-brand-600 dark:text-brand-400 mb-2">Did You Know?</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-400 leading-relaxed">
                        Consistency is key. Solving one problem a day keeps the TLE away. Keep pushing your limits!
                    </p>
                </div>

            </div>
        </div>

    </main>

    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/theme.js"></script>
    <script>
        const authInfo = checkAuth();
        if (authInfo) {
            document.getElementById('profileName').textContent = authInfo.user.name;
            document.getElementById('profileHandle').textContent = authInfo.user.cfHandle || 'N/A';
            document.getElementById('profileRole').textContent = authInfo.user.role;
            if (authInfo.user.role === 'head-admin') {
                document.getElementById('profileRole').className = 'text-xs uppercase tracking-wider bg-red-100 dark:bg-red-500/20 text-red-600 dark:text-red-400 px-2 py-1 rounded';
            } else if (authInfo.user.role === 'admin') {
                document.getElementById('profileRole').className = 'text-xs uppercase tracking-wider bg-orange-100 dark:bg-orange-500/20 text-orange-600 dark:text-orange-400 px-2 py-1 rounded';
            }
        }
    </script>
</body>

</html>